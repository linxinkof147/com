(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/search/search"],{"24a0":function(t,n,e){"use strict";e.r(n);var i=e("cdfa"),a=e("3eec");for(var u in a)"default"!==u&&function(t){e.d(n,t,function(){return a[t]})}(u);var o=e("2877"),r=Object(o["a"])(a["default"],i["a"],i["b"],!1,null,null,null);n["default"]=r.exports},"3eec":function(t,n,e){"use strict";e.r(n);var i=e("c422"),a=e.n(i);for(var u in i)"default"!==u&&function(t){e.d(n,t,function(){return i[t]})}(u);n["default"]=a.a},c422:function(t,n,e){"use strict";(function(t){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=a(e("a34a"));function a(t){return t&&t.__esModule?t:{default:t}}function u(t,n){return s(t)||r(t,n)||o()}function o(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function r(t,n){var e=[],i=!0,a=!1,u=void 0;try{for(var o,r=t[Symbol.iterator]();!(i=(o=r.next()).done);i=!0)if(e.push(o.value),n&&e.length===n)break}catch(s){a=!0,u=s}finally{try{i||null==r["return"]||r["return"]()}finally{if(a)throw u}}return e}function s(t){if(Array.isArray(t))return t}function c(t,n,e,i,a,u,o){try{var r=t[u](o),s=r.value}catch(c){return void e(c)}r.done?n(s):Promise.resolve(s).then(i,a)}function d(t){return function(){var n=this,e=arguments;return new Promise(function(i,a){var u=t.apply(n,e);function o(t){c(u,i,a,o,r,"next",t)}function r(t){c(u,i,a,o,r,"throw",t)}o(void 0)})}}var h=function(){return e.e("components/index/index-list").then(e.bind(null,"f326"))},f=function(){return e.e("components/common/no-thing").then(e.bind(null,"1306"))},l=function(){return e.e("components/common/load-more").then(e.bind(null,"fc7a"))},p=function(){return e.e("components/news/topic-list").then(e.bind(null,"a497"))},m=function(){return e.e("components/user-list/user-list").then(e.bind(null,"e563"))},g={components:{indexList:h,noThing:f,loadMore:l,topicList:p,userList:m},data:function(){return{issearch:!1,loadtext:"上拉加载更多",list:[],searchtext:"",page:1,searchType:"post"}},onNavigationBarButtonTap:function(n){0==n.index&&t.navigateBack({delta:1})},onNavigationBarSearchInputChanged:function(t){this.searchtext=t.text},onNavigationBarSearchInputConfirmed:function(t){t.text&&this.getdata()},onReachBottom:function(){this.loadmore()},onPullDownRefresh:function(){this.getdata(),t.stopPullDownRefresh()},computed:{getPlaceholder:function(){var t="文章";return"post"==this.searchType?t="文章":"topic"==this.searchType?t="话题":"user"==this.searchType&&(t="用户"),"搜索"+t}},onLoad:function(n){n&&(this.searchType=n.searchType||"post",t.$on("updateData",this.updateData))},methods:{goBack:function(){t.navigateBack({delta:1})},updateData:function(t){switch(t.type){case"guanzhu":this.updateGuanZhu(t);break;case"support":this.updateSupport(t);break;case"updateComment":this.updateComment(t);break}},updateComment:function(t){var n=this.list.find(function(n){return n.id===t.post_id});n&&n.commentnum++},updateSupport:function(t){var n=this.list.find(function(n){return n.id===t.post_id});if(n){var e=n.infonum.index;n.infonum.index="ding"==t.do?1:2,0!==e&&(1==e?n.infonum.dingnum--:n.infonum.cainum--),0!==n.infonum.index&&(1==n.infonum.index?n.infonum.dingnum++:n.infonum.cainum++)}},updateGuanZhu:function(t){this.list.forEach(function(n,e){n.userid===t.userid&&(n.isguanzhu=t.data)})},getdata:function(){var n=d(i.default.mark(function n(){var e,a,o,r,s,c,d,h,f,l=this;return i.default.wrap(function(n){while(1)switch(n.prev=n.next){case 0:return t.showLoading({title:"Loading..."}),e="/search/"+this.searchType,n.next=4,this.$http.post(e,{keyword:this.searchtext,page:this.page},{token:!0});case 4:if(a=n.sent,o=u(a,2),r=o[0],s=o[1],c=this.$http.errorCheck(r,s,function(){t.hideLoading(),l.issearch=!0},function(){t.hideLoading(),l.issearch=!0}),c){n.next=11;break}return n.abrupt("return");case 11:for(d=[],h=s.data.data.list,console.log(s),f=0;f<h.length;f++)d.push(this.__format(h[f]));this.list=this.page>1?this.list.concat(d):d,this.issearch=!0,this.loadtext=h.length<10?"没有更多数据了":"上拉加载更多",t.hideLoading();case 19:case"end":return n.stop()}},n,this)}));function e(){return n.apply(this,arguments)}return e}(),loadmore:function(){"上拉加载更多"==this.loadtext&&(this.loadtext="加载中...",this.page++,this.getdata())},__format:function(t){switch(this.searchType){case"post":return{userid:t.user.id,userpic:t.user.userpic,username:t.user.username,isguanzhu:!!t.user.fens.length,id:t.id,title:t.title,type:"img",titlepic:t.titlepic,video:!1,path:t.path,share:!!t.share,infonum:{index:t.support.length>0?t.support[0].type+1:0,dingnum:t.ding_count,cainum:t.cai_count},commentnum:t.comment_count,sharenum:t.sharenum};case"topic":return{id:t.id,titlepic:t.titlepic,title:t.title,desc:t.desc,totalnum:t.post_count,todaynum:t.todaypost_count};case"user":return{id:t.id,userpic:t.userpic,username:t.username,age:t.userinfo.age,sex:t.userinfo.sex,isguanzhu:!1}}}}};n.default=g}).call(this,e("543d")["default"])},cdfa:function(t,n,e){"use strict";var i=function(){var t=this,n=t.$createElement;t._self._c},a=[];e.d(n,"a",function(){return i}),e.d(n,"b",function(){return a})}},[["f38c","common/runtime","common/vendor"]]]);