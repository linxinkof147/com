(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-user-feedback-user-feedback"],{"0efe":function(t,e,i){"use strict";i.r(e);var a=i("b3f6"),n=i.n(a);for(var r in a)"default"!==r&&function(t){i.d(e,t,function(){return a[t]})}(r);e["default"]=n.a},2028:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",[i("v-uni-scroll-view",{style:{height:t.style.contentH+"px"},attrs:{id:"scrollview","scroll-y":"","scroll-top":t.scrollTop,"scroll-with-animation":!0}},[i("v-uni-view",{staticClass:"u-f-ajc chat-load-more",attrs:{"hover-class":"chat-load-more-hover"},on:{click:function(e){e=t.$handleEvent(e),t.loadmore(e)}}},[t._v(t._s(t.loadtext))]),t._l(t.list,function(t,e){return[i("v-uni-view",{key:e+"_0",staticClass:"chat-item"},[i("user-chat-list",{attrs:{item:t,index:e}})],1)]})],2),i("user-chat-bottom",{on:{submit:function(e){e=t.$handleEvent(e),t.submit(e)}}})],1)},n=[];i.d(e,"a",function(){return a}),i.d(e,"b",function(){return n})},"21e1":function(t,e,i){e=t.exports=i("2350")(!1),e.push([t.i,'.user-chat-list[data-v-8c395c10]{padding:%?20?% 0}.user-chat-list>uni-image[data-v-8c395c10]{width:%?100?%;height:%?100?%;border-radius:100%;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0}.user-chat-list-body[data-v-8c395c10]{position:relative;background:#f4f4f4;padding:%?25?%;margin-left:%?20?%;border-radius:%?20?%;margin-right:%?100?%}.user-chat-list-body[data-v-8c395c10]:after{position:absolute;left:%?-30?%;right:0;top:%?30?%;content:"";width:0;height:0;border:%?16?% solid #f4f4f4;border-color:rgba(0,0,0,0) #f4f4f4 rgba(0,0,0,0) rgba(0,0,0,0)}.user-chat-me[data-v-8c395c10]{-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end}.user-chat-me .user-chat-list-body[data-v-8c395c10]{margin-right:%?20?%;margin-left:%?100?%}.user-chat-me .user-chat-list-body[data-v-8c395c10]:after{left:auto;right:%?-30?%;border-color:rgba(0,0,0,0) rgba(0,0,0,0) rgba(0,0,0,0) #f4f4f4}.user-chat-list-body>uni-image[data-v-8c395c10]{max-width:%?150?%;max-height:%?200?%}.user-chat-time[data-v-8c395c10]{padding:%?50?% 0;color:#a2a2a2;font-size:%?24?%}',""])},"271a":function(t,e,i){var a=i("8499");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var n=i("4f06").default;n("0f5ecc2b",a,!0,{sourceMap:!1,shadowMode:!1})},4566:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"user-chat-bottom u-f-ac animated fadeInDown fast"},[i("v-uni-input",{attrs:{type:"text",placeholder:"文明发言",focus:t.focus},on:{blur:function(e){e=t.$handleEvent(e),t.blur(e)}},model:{value:t.text,callback:function(e){t.text=e},expression:"text"}}),i("v-uni-view",{staticClass:"icon iconfont icon-fabu u-f-ajc",on:{click:function(e){e=t.$handleEvent(e),t.submit(e)}}})],1)},n=[];i.d(e,"a",function(){return a}),i.d(e,"b",function(){return n})},4762:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a={props:{item:Object,index:Number}};e.default=a},"4a4e":function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"user-chat-item animated fadeIn fast"},[t.item.gstime?i("v-uni-view",{staticClass:"user-chat-time u-f-ajc"},[t._v(t._s(t.item.gstime))]):t._e(),i("v-uni-view",{staticClass:"user-chat-list u-f",class:{"user-chat-me":t.item.isme}},[t.item.isme?t._e():i("v-uni-image",{attrs:{src:t.item.userpic,"lazy-load":""}}),i("v-uni-view",{staticClass:"user-chat-list-body"},["text"==t.item.type?i("v-uni-text",[t._v(t._s(t.item.data))]):t._e(),"img"==t.item.type?i("v-uni-image",{attrs:{src:t.item.data,mode:"widthFix","lazy-load":""}}):t._e()],1),t.item.isme?i("v-uni-image",{attrs:{src:t.item.userpic,"lazy-load":""}}):t._e()],1)],1)},n=[];i.d(e,"a",function(){return a}),i.d(e,"b",function(){return n})},"5af0":function(t,e,i){"use strict";var a=i("be1e"),n=i.n(a);n.a},6620:function(t,e,i){"use strict";i.r(e);var a=i("ebd9"),n=i.n(a);for(var r in a)"default"!==r&&function(t){i.d(e,t,function(){return a[t]})}(r);e["default"]=n.a},"66ec":function(t,e,i){"use strict";var a=i("271a"),n=i.n(a);n.a},"6cd8":function(t,e,i){var a=i("a004");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var n=i("4f06").default;n("22820a67",a,!0,{sourceMap:!1,shadowMode:!1})},"6fbc":function(t,e,i){"use strict";var a=i("6cd8"),n=i.n(a);n.a},8499:function(t,e,i){e=t.exports=i("2350")(!1),e.push([t.i,".user-chat-bottom[data-v-578802d2]{position:fixed;bottom:0;left:0;right:0;height:%?120?%;padding:0 %?20?%;background:#fff;border-top:%?1?% solid #eee}.user-chat-bottom>uni-input[data-v-578802d2]{-webkit-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1;margin-right:%?20?%;padding:%?10?% %?20?%;border-radius:%?10?%;background:#f7f7f7}.user-chat-bottom>uni-view[data-v-578802d2]{width:%?80?%;font-size:%?45?%}",""])},"92a2":function(t,e,i){"use strict";i.r(e);var a=i("2028"),n=i("6620");for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);i("6fbc");var s=i("2877"),o=Object(s["a"])(n["default"],a["a"],a["b"],!1,null,"17b1d7d9",null);e["default"]=o.exports},a004:function(t,e,i){e=t.exports=i("2350")(!1),e.push([t.i,".chat-load-more[data-v-17b1d7d9]{padding:%?15?% 0;color:#bbb}.chat-load-more-hover[data-v-17b1d7d9]{background:#f4f4f4}",""])},aaa0:function(t,e,i){"use strict";i.r(e);var a=i("4566"),n=i("0efe");for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);i("66ec");var s=i("2877"),o=Object(s["a"])(n["default"],a["a"],a["b"],!1,null,"578802d2",null);e["default"]=o.exports},b16e:function(t,e,i){"use strict";i.r(e);var a=i("4a4e"),n=i("d2fd");for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);i("5af0");var s=i("2877"),o=Object(s["a"])(n["default"],a["a"],a["b"],!1,null,"8c395c10",null);e["default"]=o.exports},b3f6:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a={props:{focus:{type:Boolean,default:!1}},data:function(){return{text:""}},methods:{submit:function(){this.$emit("submit",this.text),this.text=""},blur:function(){this.$emit("blur")}}};e.default=a},be1e:function(t,e,i){var a=i("21e1");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var n=i("4f06").default;n("6cf1ea85",a,!0,{sourceMap:!1,shadowMode:!1})},d2fd:function(t,e,i){"use strict";i.r(e);var a=i("4762"),n=i.n(a);for(var r in a)"default"!==r&&function(t){i.d(e,t,function(){return a[t]})}(r);e["default"]=n.a},ebd9:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=o(i("a34a")),n=o(i("aaa0")),r=o(i("e6ae")),s=o(i("b16e"));function o(t){return t&&t.__esModule?t:{default:t}}function u(t){return l(t)||f(t)||c()}function c(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function f(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function l(t){if(Array.isArray(t)){for(var e=0,i=new Array(t.length);e<t.length;e++)i[e]=t[e];return i}}function d(t,e){return m(t)||v(t,e)||h()}function h(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function v(t,e){var i=[],a=!0,n=!1,r=void 0;try{for(var s,o=t[Symbol.iterator]();!(a=(s=o.next()).done);a=!0)if(i.push(s.value),e&&i.length===e)break}catch(u){n=!0,r=u}finally{try{a||null==o["return"]||o["return"]()}finally{if(n)throw r}}return i}function m(t){if(Array.isArray(t))return t}function p(t,e,i,a,n,r,s){try{var o=t[r](s),u=o.value}catch(c){return void i(c)}o.done?e(u):Promise.resolve(u).then(a,n)}function b(t){return function(){var e=this,i=arguments;return new Promise(function(a,n){var r=t.apply(e,i);function s(t){p(r,a,n,s,o,"next",t)}function o(t){p(r,a,n,s,o,"throw",t)}s(void 0)})}}var g={components:{userChatBottom:n.default,userChatList:s.default},data:function(){return{scrollTop:0,style:{contentH:0,itemH:0},list:[],page:1,loadtext:"点击加载更多"}},onReady:function(){this.getdata(),this.initdata()},methods:{initdata:function(){try{var t=uni.getSystemInfoSync();this.style.contentH=t.windowHeight-uni.upx2px(120)}catch(e){}},loadmore:function(){"点击加载更多"==this.loadtext&&(this.loadtext="加载中...",this.page++,this.getdata())},pageToBottom:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=uni.createSelectorQuery().in(this),a=i.selectAll(".chat-item");this.$nextTick(function(){a.fields({size:!0},function(i){if(i){if(e)for(var a=0;a<i.length;a++)t.style.itemH+=i[a].height;else t.style.itemH+=i[i.length-1].height;t.scrollTop=t.style.itemH>t.style.contentH?t.style.itemH:0}}).exec()})},getdata:function(){var t=b(a.default.mark(function t(){var e,i,n,s,o,c,f,l,h;return a.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e="/feedbacklist/".concat(this.page),t.next=3,this.$http.get(e,{},{token:!0,checkToken:!0});case 3:if(i=t.sent,n=d(i,2),s=n[0],o=n[1],this.$http.errorCheck(s,o)){t.next=9;break}return t.abrupt("return");case 9:for(c=o.data.data.list,f=[],l=0;l<c.length;l++)c[l].from_id!=this.User.userinfo.id&&c[l].to_id!=this.User.userinfo.id||(h=c[l].from_id==this.User.userinfo.id,f.push({isme:h,userpic:h?this.User.userinfo.userpic:"../../static/demo/userpic/11.jpg",type:"text",data:c[l].data,time:c[l].create_time,gstime:r.default.gettime.getChatTime(c[l].create_time,l>0?c[l-1].create_time:0)}));this.loadtext=c.length<10?"没有更多数据了":"点击加载更多",f.reverse(),this.list=[].concat(f,u(this.list)),1===this.page&&this.list.length>0&&this.pageToBottom(!0);case 16:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),submit:function(){var t=b(a.default.mark(function t(e){var i,n,s,o,u,c;return a.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$http.post("/feedback",{data:e},{token:!0,checkToken:!0});case 2:if(i=t.sent,n=d(i,2),s=n[0],o=n[1],this.$http.errorCheck(s,o)){t.next=8;break}return t.abrupt("return");case 8:u=(new Date).getTime(),c=r.default.gettime.getChatTime(u,this.list.length>0?this.list[this.list.length-1].time:0),this.list.push({isme:!0,userpic:this.User.userinfo.userpic,type:"text",data:e,time:u,gstime:c}),this.pageToBottom(),uni.showToast({title:"反馈成功"});case 13:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}()}};e.default=g}}]);