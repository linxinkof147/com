(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/search/search"],{"24a0":function(t,e,n){"use strict";n.r(e);var i=n("c9d0"),a=n("3eec");for(var r in a)"default"!==r&&function(t){n.d(e,t,function(){return a[t]})}(r);var u=n("2877"),o=Object(u["a"])(a["default"],i["a"],i["b"],!1,null,null,null);e["default"]=o.exports},"3eec":function(t,e,n){"use strict";n.r(e);var i=n("c422"),a=n.n(i);for(var r in i)"default"!==r&&function(t){n.d(e,t,function(){return i[t]})}(r);e["default"]=a.a},c422:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=a(n("a34a"));function a(t){return t&&t.__esModule?t:{default:t}}function r(t,e){return s(t)||o(t,e)||u()}function u(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function o(t,e){var n=[],i=!0,a=!1,r=void 0;try{for(var u,o=t[Symbol.iterator]();!(i=(u=o.next()).done);i=!0)if(n.push(u.value),e&&n.length===e)break}catch(s){a=!0,r=s}finally{try{i||null==o["return"]||o["return"]()}finally{if(a)throw r}}return n}function s(t){if(Array.isArray(t))return t}function c(t,e,n,i,a,r,u){try{var o=t[r](u),s=o.value}catch(c){return void n(c)}o.done?e(s):Promise.resolve(s).then(i,a)}function h(t){return function(){var e=this,n=arguments;return new Promise(function(i,a){var r=t.apply(e,n);function u(t){c(r,i,a,u,o,"next",t)}function o(t){c(r,i,a,u,o,"throw",t)}u(void 0)})}}var d=function(){return n.e("components/index/index-list").then(n.bind(null,"f326"))},l=function(){return n.e("components/common/no-thing").then(n.bind(null,"1306"))},p=function(){return n.e("components/common/load-more").then(n.bind(null,"fc7a"))},f=function(){return n.e("components/news/topic-list").then(n.bind(null,"a497"))},m=function(){return n.e("components/user-list/user-list").then(n.bind(null,"e563"))},g={components:{indexList:d,noThing:l,loadMore:p,topicList:f,userList:m},data:function(){return{issearch:!1,loadtext:"上拉加载更多",list:[],searchtext:"",page:1,searchType:"post"}},onNavigationBarButtonTap:function(e){0==e.index&&t.navigateBack({delta:1})},onNavigationBarSearchInputChanged:function(t){this.searchtext=t.text},onNavigationBarSearchInputConfirmed:function(t){t.text&&this.getdata()},onReachBottom:function(){this.loadmore()},onPullDownRefresh:function(){this.getdata(),t.stopPullDownRefresh()},computed:{getPlaceholder:function(){var t="文章";return"post"==this.searchType?t="文章":"topic"==this.searchType?t="话题":"user"==this.searchType&&(t="用户"),"搜索"+t}},onLoad:function(e){if(e){this.searchType=e.searchType||"post";var n="搜索文章";"topic"==this.searchType?n="搜索话题":"user"==this.searchType&&(n="搜索用户");var i=this.$mp.page.$getAppWebview(),a=i.getStyle().titleNView;a.searchInput.placeholder=n,i.setStyle({titleNView:a}),t.$on("updateData",this.updateData)}},methods:{updateData:function(t){switch(t.type){case"guanzhu":this.updateGuanZhu(t);break;case"support":this.updateSupport(t);break;case"updateComment":this.updateComment(t);break}},updateComment:function(t){var e=this.list.find(function(e){return e.id===t.post_id});e&&e.commentnum++},updateSupport:function(t){var e=this.list.find(function(e){return e.id===t.post_id});if(e){var n=e.infonum.index;e.infonum.index="ding"==t.do?1:2,0!==n&&(1==n?e.infonum.dingnum--:e.infonum.cainum--),0!==e.infonum.index&&(1==e.infonum.index?e.infonum.dingnum++:e.infonum.cainum++)}},updateGuanZhu:function(t){this.list.forEach(function(e,n){e.userid===t.userid&&(e.isguanzhu=t.data)})},getdata:function(){var e=h(i.default.mark(function e(){var n,a,u,o,s,c,h,d,l,p=this;return i.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t.showLoading({title:"Loading..."}),n="/search/"+this.searchType,e.next=4,this.$http.post(n,{keyword:this.searchtext,page:this.page},{token:!0});case 4:if(a=e.sent,u=r(a,2),o=u[0],s=u[1],c=this.$http.errorCheck(o,s,function(){t.hideLoading(),p.issearch=!0},function(){t.hideLoading(),p.issearch=!0}),c){e.next=11;break}return e.abrupt("return");case 11:for(h=[],d=s.data.data.list,console.log(s," at pages\\search\\search.vue:205"),l=0;l<d.length;l++)h.push(this.__format(d[l]));this.list=this.page>1?this.list.concat(h):h,this.issearch=!0,this.loadtext=d.length<10?"没有更多数据了":"上拉加载更多",t.hideLoading();case 19:case"end":return e.stop()}},e,this)}));function n(){return e.apply(this,arguments)}return n}(),loadmore:function(){"上拉加载更多"==this.loadtext&&(this.loadtext="加载中...",this.page++,this.getdata())},__format:function(t){switch(this.searchType){case"post":return{userid:t.user.id,userpic:t.user.userpic,username:t.user.username,isguanzhu:!!t.user.fens.length,id:t.id,title:t.title,type:"img",titlepic:t.titlepic,video:!1,path:t.path,share:!!t.share,infonum:{index:t.support.length>0?t.support[0].type+1:0,dingnum:t.ding_count,cainum:t.cai_count},commentnum:t.comment_count,sharenum:t.sharenum,sex:t.user.userinfo.sex,age:t.user.userinfo.age};case"topic":return{id:t.id,titlepic:t.titlepic,title:t.title,desc:t.desc,totalnum:t.post_count,todaynum:t.todaypost_count};case"user":return{id:t.id,userpic:t.userpic,username:t.username,age:t.userinfo.age,sex:t.userinfo.sex,isguanzhu:!1}}}}};e.default=g}).call(this,n("6e42")["default"])},c9d0:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement;t._self._c},a=[];n.d(e,"a",function(){return i}),n.d(e,"b",function(){return a})}},[["f38c","common/runtime","common/vendor"]]]);